from aiogram_dialog import Dialog, Window
from aiogram_dialog.widgets.text import Const, Format
from aiogram_dialog.widgets.input import TextInput
from aiogram_dialog.widgets.kbd import Row, Cancel, SwitchTo, Calendar, Button
from bot.states.states import CreateTaskSG
from bot.dialogs.create_task.getters import get_name
from bot.dialogs.create_task.handlers import (
    add_desc_handler,
    add_name_handler,
    add_category,
)


create_task_dialog = Dialog(
    Window(
        Format(
            "–°–æ–∑–¥–∞–Ω–∞ –∑–∞–¥–∞—á–∞ —Å –∏–º–µ–Ω–µ–º: <code>{name}</code>\
            \n–û–ø–∏—Å–∞–Ω–∏–µ: {desc}\n–ö–∞—Ç–µ–≥–æ—Ä–∏—è: {categ}\n–°—Ä–æ–∫: {due}\
            \n–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: {notice}"
        ),
        Row(
            SwitchTo(Const("–ò–º—è"), id="name", state=CreateTaskSG.name),
            SwitchTo(Const("–û–ø–∏—Å–∞–Ω–∏–µ"), id="desc", state=CreateTaskSG.desc),
        ),
        Row(
            SwitchTo(Const("–ö–∞—Ç–µ–≥–æ—Ä–∏—è"), id="categ", state=CreateTaskSG.categ),
            SwitchTo(Const("–°—Ä–æ–∫"), id="due", state=CreateTaskSG.due),
        ),
        SwitchTo(Const("–ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ"), id="notice", state=CreateTaskSG.notice),
        SwitchTo(Const("–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–¥–∞—á—É"), id="save", state=CreateTaskSG.save),
        Cancel(Const("¬´ –ù–∞–∑–∞–¥"), id="calcel"),
        state=CreateTaskSG.start,
        getter=get_name,
    ),
    Window(
        Const("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∑–∞–¥–∞—á–∏"),
        TextInput(
            id="add_name",
            on_success=add_name_handler,
        ),
        state=CreateTaskSG.name,
    ),
    Window(
        Const("–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏"),
        TextInput(id="add_desc", on_success=add_desc_handler),
        state=CreateTaskSG.desc,
    ),
    Window(
        Const("–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É"),
        Calendar(id="date", on_click=lambda x: x),
        state=CreateTaskSG.due,
    ),
    Window(
        Const("–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é"),
        Row(
            SwitchTo(
                Const("üî¥ –ö—Ä–∞—Å–Ω–∞—è"),
                id="category_1",
                state=CreateTaskSG.start,
                on_click=add_category,
            ),
            SwitchTo(
                Const("üü° –ñ–µ–ª—Ç–∞—è"),
                id="category_2",
                state=CreateTaskSG.start,
                on_click=add_category,
            ),
        ),
        Row(
            SwitchTo(
                Const("üü¢ –ó–µ–ª–µ–Ω–∞—è"),
                id="category_3",
                state=CreateTaskSG.start,
                on_click=add_category,
            ),
            SwitchTo(
                Const("üîµ –°–∏–Ω—è—è"),
                id="category_4",
                state=CreateTaskSG.start,
                on_click=add_category,
            ),
        ),
        SwitchTo(Const("¬´ –ù–∞–∑–∞–¥"), id="cancel", state=CreateTaskSG.start),
        state=CreateTaskSG.categ,
    ),
)
